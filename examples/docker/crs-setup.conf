# OWASP ModSecurity Core Rule Set (CRS) Configuration
# Adjust these settings based on your security requirements

# Paranoia Level (1-4, default: 1)
# Higher levels enable more rules but may increase false positives
SecAction \
  "id:900000,\
   phase:1,\
   nolog,\
   pass,\
   t:none,\
   setvar:tx.paranoia_level=1"

# Anomaly Scoring Threshold
# Inbound: Request anomaly score threshold (default: 5)
# Outbound: Response anomaly score threshold (default: 4)
SecAction \
  "id:900110,\
   phase:1,\
   nolog,\
   pass,\
   t:none,\
   setvar:tx.inbound_anomaly_score_threshold=5,\
   setvar:tx.outbound_anomaly_score_threshold=4"

# Application Defenses
SecAction \
  "id:900200,\
   phase:1,\
   nolog,\
   pass,\
   t:none,\
   setvar:tx.allowed_methods=GET HEAD POST OPTIONS,\
   setvar:tx.allowed_request_content_type=|application/x-www-form-urlencoded| |multipart/form-data| |application/json|,\
   setvar:tx.allowed_http_versions=HTTP/1.0 HTTP/1.1 HTTP/2 HTTP/2.0"

# HTTP Policy Settings
SecAction \
  "id:900220,\
   phase:1,\
   nolog,\
   pass,\
   t:none,\
   setvar:tx.max_num_args=255,\
   setvar:tx.arg_name_length=100,\
   setvar:tx.arg_length=400,\
   setvar:tx.total_arg_length=64000,\
   setvar:tx.max_file_size=1048576"

# Sampling Percentage (100 = process all requests)
SecAction \
  "id:900400,\
   phase:1,\
   nolog,\
   pass,\
   t:none,\
   setvar:tx.sampling_percentage=100"
